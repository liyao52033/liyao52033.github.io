<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>命令行开发 | 编程随笔</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/img/logo.png">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_3114978_qe0b39no76.css">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_3077305_pt8umhrn4k9.css">
    <link rel="stylesheet" href="//at.alicdn.com/t/c/font_4397361_l7w8pg1gfn.css">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_3114978_qe0b39no76.css">
    <meta name="description" content="编程随笔">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta name="keywords" content="编程随笔">
    <meta content="编程随笔" property="og:title">
    
    <link rel="preload" href="/assets/css/0.styles.e2f96c8e.css" as="style"><link rel="preload" href="/assets/js/app.0e4893f0.js" as="script"><link rel="preload" href="/assets/js/3.68e95ad6.js" as="script"><link rel="preload" href="/assets/js/2.56a7fb29.js" as="script"><link rel="preload" href="/assets/js/101.74a03766.js" as="script"><link rel="preload" href="/assets/js/25.571f3d43.js" as="script"><link rel="preload" href="/assets/js/45.ab1d84cf.js" as="script"><link rel="preload" href="/assets/js/44.6f56586a.js" as="script"><link rel="prefetch" href="/assets/js/1.ef8116a0.js"><link rel="prefetch" href="/assets/js/10.b7f88af7.js"><link rel="prefetch" href="/assets/js/100.3d7af52e.js"><link rel="prefetch" href="/assets/js/102.e765a012.js"><link rel="prefetch" href="/assets/js/103.51488b9f.js"><link rel="prefetch" href="/assets/js/104.263faaec.js"><link rel="prefetch" href="/assets/js/105.a1a206f3.js"><link rel="prefetch" href="/assets/js/106.b33eed10.js"><link rel="prefetch" href="/assets/js/107.9c371cef.js"><link rel="prefetch" href="/assets/js/108.1ce5ed94.js"><link rel="prefetch" href="/assets/js/109.f630eea5.js"><link rel="prefetch" href="/assets/js/11.faee59f4.js"><link rel="prefetch" href="/assets/js/110.00266b44.js"><link rel="prefetch" href="/assets/js/111.09a2c6db.js"><link rel="prefetch" href="/assets/js/112.d97cd154.js"><link rel="prefetch" href="/assets/js/113.e45a2bd2.js"><link rel="prefetch" href="/assets/js/114.9ea73cb3.js"><link rel="prefetch" href="/assets/js/115.e07a67af.js"><link rel="prefetch" href="/assets/js/116.ac66d3a2.js"><link rel="prefetch" href="/assets/js/117.6fe61452.js"><link rel="prefetch" href="/assets/js/118.d289c1ce.js"><link rel="prefetch" href="/assets/js/119.6b5d1f61.js"><link rel="prefetch" href="/assets/js/12.bacd53f3.js"><link rel="prefetch" href="/assets/js/120.717a0fe5.js"><link rel="prefetch" href="/assets/js/121.5f9db4a5.js"><link rel="prefetch" href="/assets/js/122.fd551826.js"><link rel="prefetch" href="/assets/js/123.08694ea4.js"><link rel="prefetch" href="/assets/js/124.489aa0ec.js"><link rel="prefetch" href="/assets/js/125.d66d836f.js"><link rel="prefetch" href="/assets/js/126.ce1f16d6.js"><link rel="prefetch" href="/assets/js/127.c052eebf.js"><link rel="prefetch" href="/assets/js/128.ea22cbd1.js"><link rel="prefetch" href="/assets/js/129.ce25db30.js"><link rel="prefetch" href="/assets/js/13.690ea45f.js"><link rel="prefetch" href="/assets/js/130.3ee794cc.js"><link rel="prefetch" href="/assets/js/131.e5020a3d.js"><link rel="prefetch" href="/assets/js/132.963afdf1.js"><link rel="prefetch" href="/assets/js/133.dea4c0b0.js"><link rel="prefetch" href="/assets/js/134.676e9f0f.js"><link rel="prefetch" href="/assets/js/135.7d732b20.js"><link rel="prefetch" href="/assets/js/136.c5548b0c.js"><link rel="prefetch" href="/assets/js/137.616c0ed7.js"><link rel="prefetch" href="/assets/js/138.e315e008.js"><link rel="prefetch" href="/assets/js/139.0ed71a3e.js"><link rel="prefetch" href="/assets/js/14.32a83c78.js"><link rel="prefetch" href="/assets/js/140.624f1154.js"><link rel="prefetch" href="/assets/js/141.2fb402e8.js"><link rel="prefetch" href="/assets/js/142.b9222f76.js"><link rel="prefetch" href="/assets/js/15.e7f41ace.js"><link rel="prefetch" href="/assets/js/16.4c34058c.js"><link rel="prefetch" href="/assets/js/17.4ee973ef.js"><link rel="prefetch" href="/assets/js/18.4537b4a1.js"><link rel="prefetch" href="/assets/js/19.b1adfa2e.js"><link rel="prefetch" href="/assets/js/20.2d2f5ec0.js"><link rel="prefetch" href="/assets/js/21.8c620069.js"><link rel="prefetch" href="/assets/js/22.abaca844.js"><link rel="prefetch" href="/assets/js/23.4bcd1d44.js"><link rel="prefetch" href="/assets/js/24.8038f950.js"><link rel="prefetch" href="/assets/js/26.9baa02cc.js"><link rel="prefetch" href="/assets/js/27.52bd5feb.js"><link rel="prefetch" href="/assets/js/28.4a8f2ea4.js"><link rel="prefetch" href="/assets/js/29.c5f230a2.js"><link rel="prefetch" href="/assets/js/30.0a9772e9.js"><link rel="prefetch" href="/assets/js/31.cf2ecd3c.js"><link rel="prefetch" href="/assets/js/32.fd6ebf8f.js"><link rel="prefetch" href="/assets/js/33.2d6f3e77.js"><link rel="prefetch" href="/assets/js/34.238bd5cd.js"><link rel="prefetch" href="/assets/js/35.ce5398c3.js"><link rel="prefetch" href="/assets/js/36.eb2c8d91.js"><link rel="prefetch" href="/assets/js/37.c3dd8455.js"><link rel="prefetch" href="/assets/js/38.326b72b6.js"><link rel="prefetch" href="/assets/js/39.f3716d7d.js"><link rel="prefetch" href="/assets/js/4.ca954612.js"><link rel="prefetch" href="/assets/js/40.7bacb629.js"><link rel="prefetch" href="/assets/js/41.ffa6db35.js"><link rel="prefetch" href="/assets/js/42.3e7e3b5b.js"><link rel="prefetch" href="/assets/js/43.67e6acc0.js"><link rel="prefetch" href="/assets/js/46.dd0f6b4c.js"><link rel="prefetch" href="/assets/js/47.83dbcc61.js"><link rel="prefetch" href="/assets/js/48.2adf391b.js"><link rel="prefetch" href="/assets/js/49.31016c50.js"><link rel="prefetch" href="/assets/js/5.af4b6d4f.js"><link rel="prefetch" href="/assets/js/50.fbd7b6ec.js"><link rel="prefetch" href="/assets/js/51.1378d432.js"><link rel="prefetch" href="/assets/js/52.c6d9a98a.js"><link rel="prefetch" href="/assets/js/53.55299c1d.js"><link rel="prefetch" href="/assets/js/54.ec81ce2a.js"><link rel="prefetch" href="/assets/js/55.b9f65aa8.js"><link rel="prefetch" href="/assets/js/56.e3c39f51.js"><link rel="prefetch" href="/assets/js/57.7eaa6987.js"><link rel="prefetch" href="/assets/js/58.d724256d.js"><link rel="prefetch" href="/assets/js/59.65e97ab7.js"><link rel="prefetch" href="/assets/js/6.4fff4874.js"><link rel="prefetch" href="/assets/js/60.79314c0f.js"><link rel="prefetch" href="/assets/js/61.a42c827d.js"><link rel="prefetch" href="/assets/js/62.4ed4bba8.js"><link rel="prefetch" href="/assets/js/63.c1778f4e.js"><link rel="prefetch" href="/assets/js/64.06cb129d.js"><link rel="prefetch" href="/assets/js/65.ffd81066.js"><link rel="prefetch" href="/assets/js/66.41520bd5.js"><link rel="prefetch" href="/assets/js/67.278ad307.js"><link rel="prefetch" href="/assets/js/68.a3d17362.js"><link rel="prefetch" href="/assets/js/69.63562ca7.js"><link rel="prefetch" href="/assets/js/70.bf311b4b.js"><link rel="prefetch" href="/assets/js/71.f689cfa1.js"><link rel="prefetch" href="/assets/js/72.1d975c5d.js"><link rel="prefetch" href="/assets/js/73.a27435c6.js"><link rel="prefetch" href="/assets/js/74.f5e8c8c9.js"><link rel="prefetch" href="/assets/js/75.ece2eb52.js"><link rel="prefetch" href="/assets/js/76.3195e6d1.js"><link rel="prefetch" href="/assets/js/77.f6b2d8ef.js"><link rel="prefetch" href="/assets/js/78.fd11a6bf.js"><link rel="prefetch" href="/assets/js/79.2e2437ad.js"><link rel="prefetch" href="/assets/js/80.8f38edbb.js"><link rel="prefetch" href="/assets/js/81.9bd5b23c.js"><link rel="prefetch" href="/assets/js/82.4c5327f8.js"><link rel="prefetch" href="/assets/js/83.fffee18e.js"><link rel="prefetch" href="/assets/js/84.4b9c8db9.js"><link rel="prefetch" href="/assets/js/85.ee448df3.js"><link rel="prefetch" href="/assets/js/86.bb57ceff.js"><link rel="prefetch" href="/assets/js/87.5a9aa391.js"><link rel="prefetch" href="/assets/js/88.4f9f8388.js"><link rel="prefetch" href="/assets/js/89.57f8cacf.js"><link rel="prefetch" href="/assets/js/90.4334b210.js"><link rel="prefetch" href="/assets/js/91.dd030b91.js"><link rel="prefetch" href="/assets/js/92.29ed5a98.js"><link rel="prefetch" href="/assets/js/93.4fc6381a.js"><link rel="prefetch" href="/assets/js/94.fba294a0.js"><link rel="prefetch" href="/assets/js/95.2ebcb9a6.js"><link rel="prefetch" href="/assets/js/96.537457a5.js"><link rel="prefetch" href="/assets/js/97.268e50f0.js"><link rel="prefetch" href="/assets/js/98.9323c5b2.js"><link rel="prefetch" href="/assets/js/99.8e97fec6.js"><link rel="prefetch" href="/assets/js/vendors~docs-searchbar.1d46a9b6.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.09dae32d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e2f96c8e.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="编程随笔" class="logo"> <span class="site-name can-hide">编程随笔</span></a> <div class="links"><form id="search-form" role="search" class="meilisearch-search-wrapper search-box theme-false"><input id="meilisearch-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程" class="dropdown-title"><!----> <span class="title" style="display:;">编程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/7765ba/" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/pages/17352a/" class="nav-link">后端</a></li><li class="dropdown-item"><!----> <a href="/pages/31c4d3/" class="nav-link">嵌入式</a></li><li class="dropdown-item"><!----> <a href="/pages/cf83bf/" class="nav-link">python</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目实战" class="dropdown-title"><!----> <span class="title" style="display:;">项目实战</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/7a1d12/" class="nav-link">星球项目</a></li><li class="dropdown-item"><!----> <a href="/pages/91eb9e/" class="nav-link">开源项目</a></li></ul></div></div><div class="nav-item"><a href="/pages/a5da02/" class="nav-link">工具类</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Github" class="dropdown-title"><!----> <span class="title" style="display:;">Github</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>项目仓库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/liyao52033/liyao52033.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  部署仓库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://github.com/liyao52033/vuepress-default" target="_blank" rel="noopener noreferrer" class="nav-link external">
  代码仓库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>vuepress插件</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/shanyuhai123/vuepress-plugin-auto-sidebar" target="_blank" rel="noopener noreferrer" class="nav-link external">
  自动生成导航栏与侧边栏
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://github.com/dongyuanxin/vuepress-plugin-comment" target="_blank" rel="noopener noreferrer" class="nav-link external">
  评论系统
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://github.com/meilisearch/vuepress-plugin-meilisearch" target="_blank" rel="noopener noreferrer" class="nav-link external">
  全文搜索
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://github.com/lq782655835/vuepress-plugin-element-ui" target="_blank" rel="noopener noreferrer" class="nav-link external">
  选项卡
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://github.com/ekoeryanto/vuepress-plugin-sitemap" target="_blank" rel="noopener noreferrer" class="nav-link external">
  自动生成sitemap
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>自主开发插件</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/liyao52033/vuepress-plugin-editfrontmatter" target="_blank" rel="noopener noreferrer" class="nav-link external">
  批量操作frontmatter
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://github.com/liyao52033/vuepress-plugin-replaceurl" target="_blank" rel="noopener noreferrer" class="nav-link external">
  链接美化
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://github.com/liyao52033/vuepress-plugins/tree/main/vuepress-plugin-blocktoggle" target="_blank" rel="noopener noreferrer" class="nav-link external">
  折叠代码块
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://github.com/liyao52033/vuepress-plugins/tree/main/vuepress-plugin-copycodeblock" target="_blank" rel="noopener noreferrer" class="nav-link external">
  复制代码块
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar.png"> <div class="blogger-info"><h3>liyao52033</h3> <span>走运时，要想到倒霉，不要得意得过了头；倒霉时，要想到走运，不必垂头丧气。心态始终保持平衡，情绪始终保持稳定，此亦长寿之道</span></div></div> <nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程" class="dropdown-title"><!----> <span class="title" style="display:;">编程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/7765ba/" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/pages/17352a/" class="nav-link">后端</a></li><li class="dropdown-item"><!----> <a href="/pages/31c4d3/" class="nav-link">嵌入式</a></li><li class="dropdown-item"><!----> <a href="/pages/cf83bf/" class="nav-link">python</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目实战" class="dropdown-title"><!----> <span class="title" style="display:;">项目实战</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/7a1d12/" class="nav-link">星球项目</a></li><li class="dropdown-item"><!----> <a href="/pages/91eb9e/" class="nav-link">开源项目</a></li></ul></div></div><div class="nav-item"><a href="/pages/a5da02/" class="nav-link">工具类</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Github" class="dropdown-title"><!----> <span class="title" style="display:;">Github</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>项目仓库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/liyao52033/liyao52033.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  部署仓库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://github.com/liyao52033/vuepress-default" target="_blank" rel="noopener noreferrer" class="nav-link external">
  代码仓库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>vuepress插件</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/shanyuhai123/vuepress-plugin-auto-sidebar" target="_blank" rel="noopener noreferrer" class="nav-link external">
  自动生成导航栏与侧边栏
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://github.com/dongyuanxin/vuepress-plugin-comment" target="_blank" rel="noopener noreferrer" class="nav-link external">
  评论系统
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://github.com/meilisearch/vuepress-plugin-meilisearch" target="_blank" rel="noopener noreferrer" class="nav-link external">
  全文搜索
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://github.com/lq782655835/vuepress-plugin-element-ui" target="_blank" rel="noopener noreferrer" class="nav-link external">
  选项卡
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://github.com/ekoeryanto/vuepress-plugin-sitemap" target="_blank" rel="noopener noreferrer" class="nav-link external">
  自动生成sitemap
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>自主开发插件</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/liyao52033/vuepress-plugin-editfrontmatter" target="_blank" rel="noopener noreferrer" class="nav-link external">
  批量操作frontmatter
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://github.com/liyao52033/vuepress-plugin-replaceurl" target="_blank" rel="noopener noreferrer" class="nav-link external">
  链接美化
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://github.com/liyao52033/vuepress-plugins/tree/main/vuepress-plugin-blocktoggle" target="_blank" rel="noopener noreferrer" class="nav-link external">
  折叠代码块
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://github.com/liyao52033/vuepress-plugins/tree/main/vuepress-plugin-copycodeblock" target="_blank" rel="noopener noreferrer" class="nav-link external">
  复制代码块
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span> 代码生成器</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/7a1d12/" class="sidebar-link">开发本地代码生成器</a></li><li><a href="/pages/b972ff/" aria-current="page" class="active sidebar-link">命令行开发</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/b972ff/#一、java-命令行开发方案" class="sidebar-link">一、Java 命令行开发方案</a></li><li class="sidebar-sub-header level2"><a href="/pages/b972ff/#二、picocli-命令行框架入门" class="sidebar-link">二、Picocli 命令行框架入门</a></li><li class="sidebar-sub-header level2"><a href="/pages/b972ff/#三、命令模式" class="sidebar-link">三、命令模式</a></li><li class="sidebar-sub-header level2"><a href="/pages/b972ff/#四、picocli-命令行代码生成器开发" class="sidebar-link">四、Picocli 命令行代码生成器开发</a></li></ul></li><li><a href="/pages/617ec1/" class="sidebar-link">模板生成工具</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-13c63eef><div class="articleInfo" data-v-13c63eef><ul class="breadcrumbs" data-v-13c63eef><li data-v-13c63eef><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-13c63eef></a></li> <li data-v-13c63eef><a href="/categories/?category=%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98" title="分类" data-v-13c63eef>项目实战</a></li><li data-v-13c63eef><a href="/categories/?category=%20%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E5%99%A8" title="分类" data-v-13c63eef> 代码生成器</a></li></ul> <div class="info" data-v-13c63eef><div title="作者" class="author iconfont icon-touxiang" data-v-13c63eef><a href="https://xiaoying.org.cn/" target="_blank" title="作者" class="beLink" data-v-13c63eef>华总</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-13c63eef><a href="javascript:;" data-v-13c63eef>2024-01-01</a></div> <div title="文章字数" class="book-words iconfont icon-book" style="float: left; margin-left: 20px; font-size: 0.8rem;" data-v-13c63eef><a href="javascript:;" style="margin-left: 3px; color: #888" data-v-13c63eef>0</a></div> <div title="预计阅读时间" class="reading-time iconfont icon-shijian" style="float: left; margin-left: 20px; font-size: 0.8rem;" data-v-13c63eef><a href="javascript:;" style="margin-left: 3px; color: #888" data-v-13c63eef>0</a></div> <div title="文章访问量" class="page-view iconfont icon-view" style="float: left; margin-left: 20px; font-size: 0.8rem;" data-v-13c63eef><a href="javascript:;" id="busuanzi_page_pv" class="view-data" data-v-13c63eef><i title="正在获取..." class="loading iconfont icon-loading" data-v-13c63eef></i></a></div> <div title="本文总访客量" class="page_total_view iconfont icon-tongji" style="float: left; margin-left: 20px; font-size: 0.8rem;" data-v-13c63eef><a href="javascript:;" id="busuanzi_page_uv" class="view-data" data-v-13c63eef><i title="正在获取..." class="loading iconfont icon-loading" data-v-13c63eef></i></a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">命令行开发<span class="title-tag">原创</span></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="一、java-命令行开发方案"><a href="#一、java-命令行开发方案" class="header-anchor">#</a> 一、Java 命令行开发方案</h2> <h3 id="什么是命令行程序"><a href="#什么是命令行程序" class="header-anchor">#</a> 什么是命令行程序？</h3> <p>命令行程序俗称 CLI（Command Line Interface），是指通过命令行界面运行的应用程序。通过终端窗口接收用户输入的 <strong>纯文本</strong> 命令，并执行相应的任务。</p> <p>一些常见的命令行环境包括 Unix/Linux 的终端、Windows 的命令提示符和 PowerShell 等。学编程的同学可能没有开发过命令行程序，但一定都接触过终端！</p> <h3 id="命令的结构"><a href="#命令的结构" class="header-anchor">#</a> 命令的结构</h3> <p>一图胜千言，输入给命令行的命令通常包含：</p> <ul><li>command：命令类型，具体要做的事</li> <li>option：选项，用于改变命令的行为</li> <li>parameter：参数，传递给命令行工具的值</li></ul> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181342149.png" loading="lazy" class="lazy"></p> <h3 id="为什么要开发命令行"><a href="#为什么要开发命令行" class="header-anchor">#</a> 为什么要开发命令行？</h3> <p>命令行程序的几个优点：</p> <ul><li>不依赖于特定的图形界面，非常轻量</li> <li>通常可以直接在操作系统自带的终端环境中运行</li> <li>可以和用户交互、给用户输入引导和帮助手册</li> <li>内置一些快捷操作（比如查看历史命令、上下切换命令）</li></ul> <p>还有一个最大的优点 —— 简单直接，比如复制粘贴别人写好的命令就能执行，而不用像使用网页一样点击多次，非常符合程序员的使用（偷懒）习惯，less is more！</p> <h3 id="命令行的作用"><a href="#命令行的作用" class="header-anchor">#</a> 命令行的作用</h3> <p>回归到我们的项目，命令行的作用是什么呢？</p> <p>可以使用命令行程序来和用户交互，引导用户输入代码生成的定制参数，并将输入参数封装为配置对象，然后 “喂” 给之前编写好的代码生成器来生成文件。</p> <p>比如之间我们的动态模板配置 <code>MainTemplateConfig</code> 中包含 loop、author、outputText 这 3 个参数，那么可以让用户输入下列完整命令，来给模板配置传值：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>generate <span class="token parameter variable">--loop</span> <span class="token parameter variable">--author</span> yupi <span class="token parameter variable">--outputText</span> good
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>或者更人性化一些，允许用户交互式输入，比如先输入 <code>generate</code>，然后按照系统的提示依次输入其他参数，如下图：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181342502.png" loading="lazy" class="lazy"></p> <h3 id="实现方案"><a href="#实现方案" class="header-anchor">#</a> 实现方案</h3> <p>了解了命令行的作用后，我们如何用 Java 语言开发命令行程序呢？</p> <h4 id="_1、自主实现"><a href="#_1、自主实现" class="header-anchor">#</a> 1、自主实现</h4> <p>最直接的方案就是使用 Java 内置的类库自主实现，比如通过 Scanner 读取用户的输入，再配合 while、if ... else 等流程控制语句实现多次输入和提示。</p> <p>示例代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Scanner</span> scanner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">while</span> <span class="token punctuation">(</span>scanner<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 读取整数</span>
    <span class="token keyword">int</span> number <span class="token operator">=</span> scanner<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>这种方式虽然简单，但缺点也很多：</p> <p>1）需要自主解析用户的输入</p> <p>前面已经介绍了命令的结构，可以看到一句命令可能非常复杂，包含各种选项和参数，而且用户还可能乱序输入不同的参数。</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181343026.png" loading="lazy" class="lazy"></p> <p>如何从这么一句复杂的命令中提取出需要的值，是一个难题。</p> <p>2）需要自主编写一套获取参数的交互流程</p> <p>比如用户输入了异常值怎么办？是中断程序还是给出提示？给出什么提示？这些都要开发者自己考虑。</p> <p>3）需要自主实现更多高级功能</p> <p>比如基本所有命令行工具都有的帮助手册命令（--help）、颜色高亮等。</p> <p>如果这些和业务无关的功能如果都需要自己开发，那真的是太浪费时间了！</p> <p>所以建议直接用现成的第三方命令行开发库。</p> <h4 id="_2、第三方库"><a href="#_2、第三方库" class="header-anchor">#</a> 2、第三方库</h4> <p>这里鱼皮做了充分的调研，收集了几种经典的 Java 命令行开发相关库，简单分为 3 类：</p> <p>1）命令行工具开发框架</p> <blockquote><p>专门用于开发命令行工具的框架</p></blockquote> <p>⭐️ Picocli（https://github.com/remkop/picocli）：优点是 GitHub 的 star 数多（4k+）、持续更新，支持颜色高亮、自动补全、子命令、帮助手册等，最推荐。</p> <p>2）控制台输入处理库</p> <blockquote><p>能够对用户在控制台的输入进行处理的库</p></blockquote> <p>JLine（https://github.com/jline/jline3）：支持自动补全、行编辑、查看命令历史等，但官方文档内容略少、学习成本高。参考教程：https://zhuanlan.zhihu.com/p/43835406</p> <p>3）命令行解析库</p> <blockquote><p>支持对命令行进行解析取值的库</p></blockquote> <p>⭐️ JCommander（https://github.com/cbeust/jcommander）：注解驱动，可以直接把命令映射到对象上，从而大幅简化代码。GitHub 上近 2k star，比较推荐。</p> <p><img alt="image.png" data-src="https://pic.code-nav.cn/post_picture/1610518142000300034/1936dbc8-9661-4d22-892f-f3003908c6cc.png" loading="lazy" class="lazy"></p> <p>Apache Commons CLI（https://github.com/apache/commons-cli）：简单易用，但是功能不够多。参考教程：https://blog.csdn.net/liuxiangke0210/article/details/78141887</p> <p>Jopt Simple（https://github.com/jopt-simple/jopt-simple）：不推荐。冷门、很久没维护、star 数少、生态不好。</p> <hr> <p>综上，最推荐的是专业的命令行开发框架 Picocli，下面从 0 开始带大家入门和实战这个框架。</p> <h2 id="二、picocli-命令行框架入门"><a href="#二、picocli-命令行框架入门" class="header-anchor">#</a> 二、Picocli 命令行框架入门</h2> <p>网上有关 Picocli 框架的教程非常少，最推荐的入门方式除了看鱼皮的教程外，就是阅读官方文档了。</p> <p>官方文档：https://picocli.info/</p> <p>推荐从官方提供的快速入门教程开始：https://picocli.info/quick-guide.html</p> <p>一般我们学习新技术的步骤是：先跑通入门 Demo，再学习该技术的用法和特性。</p> <h3 id="入门-demo"><a href="#入门-demo" class="header-anchor">#</a> 入门 Demo</h3> <p>1）在 <code>yuzi-generator-basic</code> 项目的 <code>pom.xml</code> 文件中引入 picocli 的依赖：</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- https://picocli.info --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>info.picocli<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>picocli<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.7.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>然后我们在 <code>com.yupi</code> 包下新建 <code>cli.example</code> 包，用于存放所有和 Picocli 入门有关的示例代码。</p> <p>2）复制官方快速入门教程中的示例代码到 <code>com.yupi.cli.example</code> 包下，并略微修改 run 方法中的代码，打印参数的值。</p> <p>完整代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>yupi<span class="token punctuation">.</span>cli<span class="token punctuation">.</span>example</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">picocli<span class="token punctuation">.</span></span><span class="token class-name">CommandLine</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">picocli<span class="token punctuation">.</span></span><span class="token class-name">CommandLine</span><span class="token punctuation">.</span><span class="token class-name">Command</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">picocli<span class="token punctuation">.</span></span><span class="token class-name">CommandLine</span><span class="token punctuation">.</span><span class="token class-name">Option</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">picocli<span class="token punctuation">.</span></span><span class="token class-name">CommandLine</span><span class="token punctuation">.</span><span class="token class-name">Parameters</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Command</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;ASCIIArt&quot;</span><span class="token punctuation">,</span> version <span class="token operator">=</span> <span class="token string">&quot;ASCIIArt 1.0&quot;</span><span class="token punctuation">,</span> mixinStandardHelpOptions <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span> 
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ASCIIArt</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span> 

    <span class="token annotation punctuation">@Option</span><span class="token punctuation">(</span>names <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;-s&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--font-size&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;Font size&quot;</span><span class="token punctuation">)</span> 
    <span class="token keyword">int</span> fontSize <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Parameters</span><span class="token punctuation">(</span>paramLabel <span class="token operator">=</span> <span class="token string">&quot;&lt;word&gt;&quot;</span><span class="token punctuation">,</span> defaultValue <span class="token operator">=</span> <span class="token string">&quot;Hello, picocli&quot;</span><span class="token punctuation">,</span> 
               description <span class="token operator">=</span> <span class="token string">&quot;Words to be translated into ASCII art.&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> words <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;Hello,&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;picocli&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> 

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 自己实现业务逻辑</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;fontSize = &quot;</span> <span class="token operator">+</span> fontSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;words = &quot;</span> <span class="token operator">+</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span> words<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> exitCode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommandLine</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ASCIIArt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span>exitCode<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>看不懂这段代码没关系，官方文档已经给了非常详细的解释：</p> <p><img alt="image.png" data-src="https://pic.code-nav.cn/post_picture/1610518142000300034/7dd52353-6ff7-4857-9e23-2c905b2a1818.png" loading="lazy" class="lazy"></p> <p>帮大家翻译一下：</p> <ol><li>创建一个实现 <code>Runnable</code> 或 <code>Callable</code> 接口的类，这就是一个命令。</li> <li>使用 <code>@Command</code> 注解标记该类并为其命名，<code>mixinStandardHelpOptions</code> 属性设置为 true 可以给应用程序自动添加 <code>--help</code> 和 <code>--version</code> 选项。</li> <li>通过 <code>@Option</code> 注解将字段设置为命令行选项，可以给选项设置名称和描述。</li> <li>通过 <code>@Parameters</code> 注解将字段设置为命令行参数，可以指定默认值、描述等信息。</li> <li>Picocli 会将命令行参数转换为强类型值，并自动注入到注解字段中。</li> <li>在类的 <code>run</code> 或 <code>call</code> 方法中定义业务逻辑，当命令解析成功（用户敲了回车）后被调用。</li> <li>在 <code>main</code> 方法中，通过 <code>CommandLine</code> 对象的 <code>execute</code> 方法来处理用户输入的命令，剩下的就交给 Picocli 框架来解析命令并执行业务逻辑啦~</li> <li><code>CommandLine.execute</code> 方法返回一个退出代码。可以调用 <code>System.exit</code> 并将该退出代码作为参数，从而向调用进程表示成功或失败。</li></ol> <p>3）让我们更改主程序的执行参数（args）来测试程序，能够成功看到输出结果，如下图：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181343904.png" loading="lazy" class="lazy"></p> <p>通过这个入门 Demo，我们可以简单总结一个命令的开发流程：</p> <ol><li>创建命令</li> <li>设置选项和参数</li> <li>编写命令执行的业务逻辑</li> <li>通过 CommandLine 对象接受输入并执行命令</li></ol> <p>在跑通了入门 Demo 后，我们来学习一些 Picocli 开发命令行的实用功能。</p> <h3 id="实用功能"><a href="#实用功能" class="header-anchor">#</a> 实用功能</h3> <h4 id="_1、帮助手册"><a href="#_1、帮助手册" class="header-anchor">#</a> 1、帮助手册</h4> <p>通过给类添加的 <code>@Command</code> 注解参数 <code>mixinStandardHelpOptions</code> 设置为 true 来开启：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Command</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;ASCIIArt&quot;</span><span class="token punctuation">,</span> mixinStandardHelpOptions <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>然后将主程序的输入参数设置为 <code>--help</code> 就能打印出命令的帮助手册信息了，如下图：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181343612.png" loading="lazy" class="lazy"></p> <p>可以看到，Picocli 生成的帮助手册不仅规范、而且清晰完整。</p> <h4 id="_2、命令解析"><a href="#_2、命令解析" class="header-anchor">#</a> 2、命令解析</h4> <p>Picocli 最核心的能力就是命令解析，能够从一句完整的命令中解析选项和参数，并填充到对象的属性中。</p> <p>Picocli 使用注解的方式实现命令解析，不需要自己编写代码，整个类看起来非常清晰。</p> <p>最核心的 2 个注解其实在入门 Demo 中我们已经使用到了：</p> <ul><li><code>@Option</code> 注解用于解析选项</li> <li><code>@Parameters</code> 注解用于解析参数</li></ul> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181343992.png" loading="lazy" class="lazy"></p> <p>示例代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Option</span><span class="token punctuation">(</span>names <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;-s&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--font-size&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;Font size&quot;</span><span class="token punctuation">)</span> 
<span class="token keyword">int</span> fontSize <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Parameters</span><span class="token punctuation">(</span>paramLabel <span class="token operator">=</span> <span class="token string">&quot;&lt;word&gt;&quot;</span><span class="token punctuation">,</span> defaultValue <span class="token operator">=</span> <span class="token string">&quot;Hello, picocli&quot;</span><span class="token punctuation">,</span> 
           description <span class="token operator">=</span> <span class="token string">&quot;Words to be translated into ASCII art.&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> words <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;Hello,&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;picocli&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>可以给这些注解指定参数，比较常用的参数有：</p> <p>1）@Option 注解的 names 参数：指定选项英文名称。</p> <p>2）description 参数：指定描述信息，从而让生成的帮助手册和提示信息更清晰。</p> <p>3）@Parameters 注解的 paramLabel 参数：参数标签，作用类似于描述信息。</p> <p>4）@Parameters 注解的 defaultValue 参数：默认值，参考文档：https://picocli.info/#_default_values</p> <p>5）required 参数：要求必填，参考文档：https://picocli.info/#_required_arguments</p> <p>示例代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">RequiredOption</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Option</span><span class="token punctuation">(</span>names <span class="token operator">=</span> <span class="token string">&quot;-a&quot;</span><span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token class-name">String</span> author<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>此外，命令解析天然支持 <strong>多值选项</strong> ，只需要把对象属性的类型设置为数组类型即可，比如：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Option</span><span class="token punctuation">(</span>names <span class="token operator">=</span> <span class="token string">&quot;-option&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>具体可以参考官方文档：https://picocli.info/#_multiple_values</p> <p>更多关于选项和参数注解的用法，也可以阅读官方文档学习：https://picocli.info/quick-guide.html#_options_and_parameters</p> <h4 id="_3、交互式输入"><a href="#_3、交互式输入" class="header-anchor">#</a> 3、交互式输入</h4> <p>所谓的交互式输入就是允许用户像跟程序聊天一样，在程序的指引下一个参数一个参数地输入。</p> <p>如下图：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181343524.png" loading="lazy" class="lazy"></p> <p>Picocli 为交互式输入提供了很好的支持，我梳理了大概 4 种交互式输入的模式。</p> <h5 id="_1-基本能力"><a href="#_1-基本能力" class="header-anchor">#</a> 1）基本能力</h5> <p>交互式输入的一个典型应用场景就是：用户要登录时，引导 ta 输入密码。</p> <p>官方已经为我们提供了一段交互式输入的示例代码，鱼皮对它进行了简化，示例代码如下：</p> <blockquote><p>参考官方文档：https://picocli.info/#_interactive_password_options</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>yupi<span class="token punctuation">.</span>cli<span class="token punctuation">.</span>example</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">picocli<span class="token punctuation">.</span></span><span class="token class-name">CommandLine</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">picocli<span class="token punctuation">.</span></span><span class="token class-name">CommandLine</span><span class="token punctuation">.</span><span class="token class-name">Option</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">Callable</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Login</span> <span class="token keyword">implements</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Option</span><span class="token punctuation">(</span>names <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;-u&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--user&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;User name&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">String</span> user<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Option</span><span class="token punctuation">(</span>names <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;-p&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--password&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;Passphrase&quot;</span><span class="token punctuation">,</span> interactive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token class-name">String</span> password<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;password = &quot;</span> <span class="token operator">+</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">CommandLine</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">&quot;-u&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user123&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-p&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>让我们分析下上面的代码，主要包含 4 个部分：</p> <p>1）首先命令类需要实现 <code>Callable</code> 接口</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Login</span> <span class="token keyword">implements</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>2）将 <code>@Option</code> 注解的 <code>interactive</code> 参数设置为 true，表示该选项支持交互式输入</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Option</span><span class="token punctuation">(</span>names <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;-p&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--password&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> interactive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token class-name">String</span> password<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>3）在所有参数都输入完成后，会执行 <code>call</code> 方法，可以在该方法中编写具体的业务逻辑：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;password = &quot;</span> <span class="token operator">+</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>4）在 Main 方法中执行命令并传入参数：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>java

<span class="token keyword">new</span> <span class="token class-name">CommandLine</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">&quot;-u&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user123&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-p&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>执行上述代码，看到程序提示我们输入密码：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181343406.png" loading="lazy" class="lazy"></p> <p>注意，如果以 jar 包方式运行上述程序，用户的输入默认是不会显示在控制台的（类似输入密码时的体验）。从 Picocli 4.6 版本开始，可以通过指定 <code>@Option</code> 注解的 <code>echo</code> 参数为 true 来显示用户的输入，并通过 <code>prompt</code> 参数指定引导用户输入的提示语。</p> <h5 id="_2-多个选项交互式"><a href="#_2-多个选项交互式" class="header-anchor">#</a> 2）多个选项交互式</h5> <p>Picocli 支持在一个命令中指定多个交互式输入的选项，会按照顺序提示用户并接收输入。</p> <p>在上述代码中再增加一个 checkPassword 选项，同样开启交互式输入，代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Login</span> <span class="token keyword">implements</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Option</span><span class="token punctuation">(</span>names <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;-u&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--user&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;User name&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">String</span> user<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Option</span><span class="token punctuation">(</span>names <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;-p&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--password&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;Passphrase&quot;</span><span class="token punctuation">,</span> interactive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token class-name">String</span> password<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Option</span><span class="token punctuation">(</span>names <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;-cp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--checkPassword&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;Check Password&quot;</span><span class="token punctuation">,</span> interactive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token class-name">String</span> checkPassword<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;password = &quot;</span> <span class="token operator">+</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;checkPassword = &quot;</span> <span class="token operator">+</span> checkPassword<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">CommandLine</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">&quot;-u&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user123&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-p&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>但运行上述代码我们会发现，怎么只提示我输入了密码，没提示我输入确认密码呢？</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181343708.png" loading="lazy" class="lazy"></p> <p>这是由于 Picocli 框架的规则，用户必须在命令中指定需要交互式输入的选项（比如 <code>-p</code>），才会引导用户输入。</p> <p>所以我们需要修改上述代码中的 main 方法，给命令输入补充 <code>-cp</code> 参数：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token class-name">CommandLine</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">&quot;-u&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user123&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-p&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-cp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>再次执行，这下程序会依次提醒我们输入两个选项啦：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181343655.png" loading="lazy" class="lazy"></p> <p>根据实际使用情况，又可以将交互式输入分为 2 种模式：</p> <ul><li>可选交互式：用户可以直接在整行命令中输入选项，而不用给用户提示信息。</li> <li>强制交互式：用户必须获得提示并输入某个选项，不允许不填写。</li></ul> <p>下面分别讲解这两种模式。</p> <h5 id="_3-可选交互式"><a href="#_3-可选交互式" class="header-anchor">#</a> 3）可选交互式</h5> <p>默认情况下，是无法直接在命令中给交互式选项指定任何参数的，只能通过交互式输入，比如命令中包含 <code>-p xxx</code> 会报错。</p> <blockquote><p>可选交互式官方文档：https://picocli.info/#_optionally_interactive</p></blockquote> <p>让我们测试一下，给上面的示例代码输入以下参数：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">new</span> <span class="token class-name">CommandLine</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">&quot;-u&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user123&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-p&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-cp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>执行效果如下图，出现了参数不匹配的报错：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181343795.png" loading="lazy" class="lazy"></p> <p>官方提供了可选交互式的解决方案，通过调整 <code>@Option</code> 注解中的 <code>arity</code> 属性来指定每个选项可接受的参数个数，就能解决这个问题。</p> <blockquote><p>arity 官方介绍：https://picocli.info/#_arity</p></blockquote> <p>示例代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Option</span><span class="token punctuation">(</span>names <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;-p&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--password&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> arity <span class="token operator">=</span> <span class="token string">&quot;0..1&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;Passphrase&quot;</span><span class="token punctuation">,</span> interactive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token class-name">String</span> password<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>然后可以直接在完整命令中给交互式选项设置值：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>
<span class="token keyword">new</span> <span class="token class-name">CommandLine</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">&quot;-u&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user123&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-p&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-cp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>执行结果如图，不再提示让用户输入 password 选项，而是直接读取了命令中的值：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181343943.png" loading="lazy" class="lazy"></p> <p>这里鱼皮推荐一个最佳实践：建议给所有需要交互式输入的选项都增加 <code>arity</code> 参数（一般是 <code>arity = &quot;0..1&quot;</code>），这样用户既可以在完整命令中直接给选项填充参数，也可以选择交互式输入。</p> <p>示例代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Login</span> <span class="token keyword">implements</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Option</span><span class="token punctuation">(</span>names <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;-u&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--user&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;User name&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">String</span> user<span class="token punctuation">;</span>

    <span class="token comment">// 设置了 arity 参数，可选交互式</span>
    <span class="token annotation punctuation">@Option</span><span class="token punctuation">(</span>names <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;-p&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--password&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> arity <span class="token operator">=</span> <span class="token string">&quot;0..1&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;Passphrase&quot;</span><span class="token punctuation">,</span> interactive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token class-name">String</span> password<span class="token punctuation">;</span>

    <span class="token comment">// 设置了 arity 参数，可选交互式</span>
    <span class="token annotation punctuation">@Option</span><span class="token punctuation">(</span>names <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;-cp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--checkPassword&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> arity <span class="token operator">=</span> <span class="token string">&quot;0..1&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;Check Password&quot;</span><span class="token punctuation">,</span> interactive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token class-name">String</span> checkPassword<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;password = &quot;</span> <span class="token operator">+</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;checkPassword = &quot;</span> <span class="token operator">+</span> checkPassword<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">CommandLine</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">&quot;-u&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user123&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-p&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-cp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h5 id="_4-强制交互式"><a href="#_4-强制交互式" class="header-anchor">#</a> 4）强制交互式</h5> <p>在之前已经提到，如果用户不在命令中输入交互式选项（比如 <code>-p</code>），那么系统不会提示用户输入这个选项，属性的值将为默认值（比如 null）。</p> <p>举个例子，下列命令中不带 <code>-p</code> 选项：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>java

<span class="token keyword">new</span> <span class="token class-name">CommandLine</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">&quot;-u&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>执行就会发现，程序不会提示用户输入 <code>-p</code> 选项的参数，而是直接输出结果，值为 null：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181343968.png" loading="lazy" class="lazy"></p> <p>但有些时候，我们要求用户必须输入某个选项，而不能使用默认的空值，怎么办呢？</p> <p>官方给出了强制交互式的解决方案，参考文档：https://picocli.info/#_forcing_interactive_input</p> <p>但是，官方的解决方案是需要自己定义业务逻辑的。原理是在命令执行后对属性进行判断，如果用户没有输入指定的参数，那么再通过 <code>System.console().readLine</code> 等方式提示用户输入，示例代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Command</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Option</span><span class="token punctuation">(</span>names <span class="token operator">=</span> <span class="token string">&quot;--interactive&quot;</span><span class="token punctuation">,</span> interactive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token class-name">String</span> value<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">console</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 主动提示用户输入</span>
            value <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">console</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token string">&quot;Enter value for --interactive: &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;You provided value '&quot;</span> <span class="token operator">+</span> value <span class="token operator">+</span> <span class="token string">&quot;'&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">CommandLine</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>个人不是很喜欢这种方案，因为要额外编写提示代码，感觉又回到自主实现了。</p> <p>鱼皮想出的一种方案是，编写一段通用的校验程序，如果用户的输入命令中没有包含交互式选项，那么就自动为输入命令补充该选项即可，这样就能强制触发交互式输入。</p> <p>说通俗一点，检测 args 数组中是否存在对应选项，不存在则为数组增加选项元素。</p> <p>该思路作为一个小扩展点，实现起来并不复杂，大家可以自行实现。（小提示：可以利用反射自动读取必填的选项名称）</p> <h4 id="_4、子命令"><a href="#_4、子命令" class="header-anchor">#</a> 4、子命令</h4> <p>子命令是指命令中又包含一组命令，相当于命令的分组嵌套，适用于功能较多、较为复杂的命令行程序，比如 git、docker 命令等。</p> <p>官方文档：https://picocli.info/#_subcommands</p> <p>在 Picocli 中，提供了两种设置子命令的方式。</p> <h5 id="_1-声明式"><a href="#_1-声明式" class="header-anchor">#</a> 1）声明式</h5> <p>通过 <code>@Command</code> 注解的 <code>subcommands</code> 属性来给命令添加子命令，优点是更直观清晰。</p> <p>示例代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Command</span><span class="token punctuation">(</span>subcommands <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token class-name">GitStatus</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
    <span class="token class-name">GitCommit</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
    <span class="token class-name">GitAdd</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
    <span class="token class-name">GitBranch</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
    <span class="token class-name">GitCheckout</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
    <span class="token class-name">GitClone</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
    <span class="token class-name">GitDiff</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
    <span class="token class-name">GitMerge</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
    <span class="token class-name">GitPush</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
    <span class="token class-name">GitRebase</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
    <span class="token class-name">GitTag</span><span class="token punctuation">.</span><span class="token keyword">class</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Git</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h5 id="_2-编程式"><a href="#_2-编程式" class="header-anchor">#</a> 2）编程式</h5> <p>在创建 <code>CommandLine</code> 对象时，调用 <code>addSubcommand</code> 方法来绑定子命令，优点是更灵活。</p> <p>示例代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">CommandLine</span> commandLine <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommandLine</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Git</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">addSubcommand</span><span class="token punctuation">(</span><span class="token string">&quot;status&quot;</span><span class="token punctuation">,</span>   <span class="token keyword">new</span> <span class="token class-name">GitStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">addSubcommand</span><span class="token punctuation">(</span><span class="token string">&quot;commit&quot;</span><span class="token punctuation">,</span>   <span class="token keyword">new</span> <span class="token class-name">GitCommit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">addSubcommand</span><span class="token punctuation">(</span><span class="token string">&quot;add&quot;</span><span class="token punctuation">,</span>      <span class="token keyword">new</span> <span class="token class-name">GitAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">addSubcommand</span><span class="token punctuation">(</span><span class="token string">&quot;branch&quot;</span><span class="token punctuation">,</span>   <span class="token keyword">new</span> <span class="token class-name">GitBranch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">addSubcommand</span><span class="token punctuation">(</span><span class="token string">&quot;checkout&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">GitCheckout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">addSubcommand</span><span class="token punctuation">(</span><span class="token string">&quot;clone&quot;</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token class-name">GitClone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">addSubcommand</span><span class="token punctuation">(</span><span class="token string">&quot;diff&quot;</span><span class="token punctuation">,</span>     <span class="token keyword">new</span> <span class="token class-name">GitDiff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">addSubcommand</span><span class="token punctuation">(</span><span class="token string">&quot;merge&quot;</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token class-name">GitMerge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">addSubcommand</span><span class="token punctuation">(</span><span class="token string">&quot;push&quot;</span><span class="token punctuation">,</span>     <span class="token keyword">new</span> <span class="token class-name">GitPush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">addSubcommand</span><span class="token punctuation">(</span><span class="token string">&quot;rebase&quot;</span><span class="token punctuation">,</span>   <span class="token keyword">new</span> <span class="token class-name">GitRebase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">addSubcommand</span><span class="token punctuation">(</span><span class="token string">&quot;tag&quot;</span><span class="token punctuation">,</span>      <span class="token keyword">new</span> <span class="token class-name">GitTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h5 id="实践"><a href="#实践" class="header-anchor">#</a> 实践</h5> <p>让我们编写一个示例程序，支持增加、删除、查询 3 个子命令，并传入不同的 args 来测试效果。</p> <p>完整代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>yupi<span class="token punctuation">.</span>cli<span class="token punctuation">.</span>example</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">picocli<span class="token punctuation">.</span></span><span class="token class-name">CommandLine</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">picocli<span class="token punctuation">.</span></span><span class="token class-name">CommandLine</span><span class="token punctuation">.</span><span class="token class-name">Command</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Command</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;main&quot;</span><span class="token punctuation">,</span> mixinStandardHelpOptions <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SubCommandExample</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;执行主命令&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Command</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;add&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;增加&quot;</span><span class="token punctuation">,</span> mixinStandardHelpOptions <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">AddCommand</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;执行增加命令&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Command</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;delete&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;删除&quot;</span><span class="token punctuation">,</span> mixinStandardHelpOptions <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">DeleteCommand</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;执行删除命令&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Command</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;query&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;查询&quot;</span><span class="token punctuation">,</span> mixinStandardHelpOptions <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">QueryCommand</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;执行查询命令&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 执行主命令</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> myArgs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token comment">// 查看主命令的帮助手册</span>
<span class="token comment">//        String[] myArgs = new String[] { &quot;--help&quot; };</span>
        <span class="token comment">// 执行增加命令</span>
<span class="token comment">//        String[] myArgs = new String[] { &quot;add&quot; };</span>
        <span class="token comment">// 执行增加命令的帮助手册</span>
<span class="token comment">//        String[] myArgs = new String[] { &quot;add&quot;, &quot;--help&quot; };</span>
        <span class="token comment">// 执行不存在的命令，会报错</span>
<span class="token comment">//        String[] myArgs = new String[] { &quot;update&quot; };</span>
        <span class="token keyword">int</span> exitCode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommandLine</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SubCommandExample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addSubcommand</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AddCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addSubcommand</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DeleteCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addSubcommand</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">QueryCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>myArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span>exitCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><p>测试运行，发现当输入 <code>--help</code> 参数时，打印出了主命令和所有的子命令信息，证明子命令绑定成功：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181343131.png" loading="lazy" class="lazy"></p> <h4 id="_5、其他功能"><a href="#_5、其他功能" class="header-anchor">#</a> 5、其他功能</h4> <p>除了上面演示的功能外，还有一些可能有用的功能，大家感兴趣了解下就好，不要作为重点学习。</p> <p>比如：</p> <ul><li>参数分组：https://picocli.info/#_argument_groups</li> <li>错误处理：https://picocli.info/#_handling_errors</li> <li>颜色高亮：https://picocli.info/#_ansi_colors_and_styles</li></ul> <h3 id="更多学习资源"><a href="#更多学习资源" class="header-anchor">#</a> 更多学习资源</h3> <p>关于 Picocli 的学习资源极少，还是以官方文档为主。</p> <p>分享一篇还算完整的博客：</p> <ul><li>Picocli 中文入门学习：https://blog.csdn.net/it_freshman/article/details/125458116</li></ul> <h2 id="三、命令模式"><a href="#三、命令模式" class="header-anchor">#</a> 三、命令模式</h2> <p>已经入门了 Picocli 命令行框架，在正式运用它来开发代码生成器项目前，我们要先来学习一种经典的设计模式 —— 命令模式，这样有利于理解后面的代码开发。</p> <h3 id="什么是命令模式"><a href="#什么是命令模式" class="header-anchor">#</a> 什么是命令模式？</h3> <p>命令模式是一种行为类设计模式，核心是将每种请求或操作封装为一个独立的对象，从而可以集中管理这些请求或操作，比如将请求队列化依次执行、或者对操作进行记录和撤销。</p> <p>命令模式通过将请求的发送者（客户端）和接收者（执行请求的对象）解耦，提供了更大的灵活性和可维护性。</p> <p>听不懂上面这句话很正常，我来举个例子。</p> <p>我们在生活中都用过电视机，<code>我们</code> 就相当于客户端，要操作电视来换台；而 <code>电视</code> 就是执行请求的对象，要根据我们的操作来换台。但是我们一般不会直接按电视上的按钮来换台，而是用一个 <code>遥控器</code>，通过点击遥控器上的 <code>操作按钮</code> 来控制电视。</p> <p>这样就相当于把我们和电视解耦了。哪怕遥控器丢了，再换一个遥控器就好了；而且现在手机都能作为万能的电视遥控器，我们可以同时遥控多个品牌的设备，不用关心设备的具体品牌型号，提供了更大的方便。</p> <h3 id="命令模式的优点和应用场景"><a href="#命令模式的优点和应用场景" class="header-anchor">#</a> 命令模式的优点和应用场景</h3> <p>正如上面的例子，命令模式最大的优点就是解耦请求发送者和接受者，让系统更加灵活、可扩展。</p> <p>由于每个操作都是一个独立的命令类，所以我们需要新增命令操作时，不需要改动现有代码。</p> <p>命令模式典型的应用场景：</p> <ul><li>系统需要统一处理多种复杂的操作，比如操作排队、记录操作历史、撤销重做等。</li> <li>系统需要持续增加新的命令、或者要处理复杂的组合命令（子命令），使用命令模式可以实现解耦。</li></ul> <p>本项目要开发的命令行工具，就符合这两个应用场景。</p> <h3 id="命令模式的要素和实现"><a href="#命令模式的要素和实现" class="header-anchor">#</a> 命令模式的要素和实现</h3> <p>通过上面用户使用遥控器来操作电视机设备的例子，带大家理解命令模式的关键要素和实现代码。</p> <blockquote><p>以下所有示例代码放到 <code>com.yupi.cli.pattern</code> 包中</p></blockquote> <h4 id="_1-命令"><a href="#_1-命令" class="header-anchor">#</a> 1）命令</h4> <blockquote><p>相当于遥控器操作按钮的制作规范</p></blockquote> <p>命令是一个抽象类或接口，它定义了执行操作的方法，通常是 <code>execute</code>，该方法封装了具体的操作。</p> <p>代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Command</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_2-具体命令"><a href="#_2-具体命令" class="header-anchor">#</a> 2）具体命令</h4> <blockquote><p>相当于遥控器的某个操作按钮</p></blockquote> <p>具体命令是命令接口的具体实现类，它负责将请求传递给接收者（设备）并执行具体的操作。</p> <p>比如定义一个关闭设备命令，代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TurnOffCommand</span> <span class="token keyword">implements</span> <span class="token class-name">Command</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Device</span> device<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">TurnOffCommand</span><span class="token punctuation">(</span><span class="token class-name">Device</span> device<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>device <span class="token operator">=</span> device<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        device<span class="token punctuation">.</span><span class="token function">turnOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>还可以定义开启设备命令，代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TurnOnCommand</span> <span class="token keyword">implements</span> <span class="token class-name">Command</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Device</span> device<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">TurnOnCommand</span><span class="token punctuation">(</span><span class="token class-name">Device</span> device<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>device <span class="token operator">=</span> device<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        device<span class="token punctuation">.</span><span class="token function">turnOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="_3-接受者"><a href="#_3-接受者" class="header-anchor">#</a> 3）接受者</h4> <blockquote><p>相当于被遥控的设备</p></blockquote> <p>接收者是最终执行命令的对象，知道如何执行具体的操作。</p> <p>比如定义一个设备类，代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Device</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Device</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">turnOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">&quot; 设备打开&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">turnOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">&quot; 设备关闭&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="_4-调用者"><a href="#_4-调用者" class="header-anchor">#</a> 4）调用者</h4> <blockquote><p>相当于遥控器</p></blockquote> <p>作用是接受客户端的命令并执行。</p> <p>比如定义遥控器类，代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RemoteControl</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Command</span> command<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCommand</span><span class="token punctuation">(</span><span class="token class-name">Command</span> command<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>command <span class="token operator">=</span> command<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pressButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        command<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>以上只是最基础的调用者类，还可以给遥控器类增加更多能力，比如存储历史记录、撤销重做等。</p> <h4 id="_5-客户端"><a href="#_5-客户端" class="header-anchor">#</a> 5）客户端</h4> <blockquote><p>相当于使用遥控器的人</p></blockquote> <p>客户端的作用是创建命令对象并将其与接收者关联（绑定设备），然后将命令对象传递给调用者（按遥控器），从而触发执行。</p> <p>示例客户端代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 创建接收者对象</span>
        <span class="token class-name">Device</span> tv <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Device</span><span class="token punctuation">(</span><span class="token string">&quot;TV&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Device</span> stereo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Device</span><span class="token punctuation">(</span><span class="token string">&quot;Stereo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 创建具体命令对象，可以绑定不同设备</span>
        <span class="token class-name">TurnOnCommand</span> turnOn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TurnOnCommand</span><span class="token punctuation">(</span>tv<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">TurnOffCommand</span> turnOff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TurnOffCommand</span><span class="token punctuation">(</span>stereo<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 创建调用者</span>
        <span class="token class-name">RemoteControl</span> remote <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RemoteControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 执行命令</span>
        remote<span class="token punctuation">.</span><span class="token function">setCommand</span><span class="token punctuation">(</span>turnOn<span class="token punctuation">)</span><span class="token punctuation">;</span>
        remote<span class="token punctuation">.</span><span class="token function">pressButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        remote<span class="token punctuation">.</span><span class="token function">setCommand</span><span class="token punctuation">(</span>turnOff<span class="token punctuation">)</span><span class="token punctuation">;</span>
        remote<span class="token punctuation">.</span><span class="token function">pressButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>在这个示例中，命令模式将遥控器按钮的按下操作与实际设备的开关操作解耦，从而实现了灵活的控制和可扩展性。</p> <p>整个程序的 UML 类图如下：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181344895.png" loading="lazy" class="lazy"></p> <p>视频教程中有给大家演示使用 IDEA 来生成 UML 图的方法。</p> <h3 id="推荐学习"><a href="#推荐学习" class="header-anchor">#</a> 推荐学习</h3> <p>鱼皮独立开发的 yuindex 网页终端项目，就是以命令模式为核心实现的，前后端同学都可以学习：https://github.com/liyupi/yuindex</p> <h2 id="四、picocli-命令行代码生成器开发"><a href="#四、picocli-命令行代码生成器开发" class="header-anchor">#</a> 四、Picocli 命令行代码生成器开发</h2> <p>学习了 Picocli 框架的用法和命令模式后，我们可以运用它们来开发一款命令行代码生成器啦。</p> <p>首先明确我们的需求，这个命令行程序需要支持 3 种子命令：</p> <ul><li>generate 子命令：生成文件</li> <li>list 子命令：查看要生成的原始文件列表信息</li> <li>config 子命令：查看允许用户传入的动态参数信息</li></ul> <p>为了简化使用，要求能同时支持通过完整命令和交互式输入的方式来设置动态参数。</p> <p>整个开发过程分为 6 个步骤：</p> <ol><li>创建命令执行器（主命令）</li> <li>分别实现每种子命令</li> <li>提供项目的全局调用入口</li> <li>构建程序 jar 包</li> <li>测试使用</li> <li>简化使用（封装脚本）</li></ol> <h3 id="_1、创建命令执行器"><a href="#_1、创建命令执行器" class="header-anchor">#</a> 1、创建命令执行器</h3> <p>首先在 <code>com.yupi.cli.command</code> 包下新建 3 个子命令类，和需求对应：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181344837.png" loading="lazy" class="lazy"></p> <p>然后在 <code>com.yupi.cli</code> 包下创建命令执行器 <code>CommandExecutor</code> 类，负责绑定所有子命令，并且提供执行命令的方法。</p> <p>完整代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Command</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;yuzi&quot;</span><span class="token punctuation">,</span> mixinStandardHelpOptions <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommandExecutor</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">CommandLine</span> commandLine<span class="token punctuation">;</span>

    <span class="token punctuation">{</span>
        commandLine <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommandLine</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addSubcommand</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GenerateCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addSubcommand</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ConfigCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addSubcommand</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ListCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 不输入子命令时，给出友好提示</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;请输入具体命令，或者输入 --help 查看命令提示&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 执行命令
     *
     * @param args
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">doExecute</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> commandLine<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="_2、子命令实现"><a href="#_2、子命令实现" class="header-anchor">#</a> 2、子命令实现</h3> <h4 id="generate-子命令"><a href="#generate-子命令" class="header-anchor">#</a> generate 子命令</h4> <p>这是代码生成器的核心命令，作用是接受参数并生成代码。</p> <p>实现步骤如下：</p> <p>1）定义参数选项。和之前动态生成代码定义的数据模型 <code>MainTemplateConfig</code> 属性一致即可。使用 Picocli 提供的注解来交互式获取参数信息（interactive = true），并且对用户显示输入信息（echo = true）。</p> <p>2）使用 <code>BeanUtil.copyProperties</code> 快速将通过命令接受到的属性复制给 <code>MainTemplateConfig</code> 配置对象。</p> <p>3）调用之前开发好的 <code>MainGenerator</code> 代码生成类来生成代码。</p> <p>完整代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Command</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;generate&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;生成代码&quot;</span><span class="token punctuation">,</span> mixinStandardHelpOptions <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GenerateCommand</span> <span class="token keyword">implements</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Option</span><span class="token punctuation">(</span>names <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;-l&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--loop&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> arity <span class="token operator">=</span> <span class="token string">&quot;0..1&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;是否循环&quot;</span><span class="token punctuation">,</span> interactive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> echo <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> loop<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Option</span><span class="token punctuation">(</span>names <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;-a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--author&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> arity <span class="token operator">=</span> <span class="token string">&quot;0..1&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;作者&quot;</span><span class="token punctuation">,</span> interactive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> echo <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> author <span class="token operator">=</span> <span class="token string">&quot;yupi&quot;</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Option</span><span class="token punctuation">(</span>names <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;-o&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;--outputText&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> arity <span class="token operator">=</span> <span class="token string">&quot;0..1&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;输出文本&quot;</span><span class="token punctuation">,</span> interactive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> echo <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> outputText <span class="token operator">=</span> <span class="token string">&quot;sum = &quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">MainTemplateConfig</span> mainTemplateConfig <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MainTemplateConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BeanUtil</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> mainTemplateConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;配置信息：&quot;</span> <span class="token operator">+</span> mainTemplateConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">MainGenerator</span><span class="token punctuation">.</span><span class="token function">doGenerate</span><span class="token punctuation">(</span>mainTemplateConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h4 id="list-子命令"><a href="#list-子命令" class="header-anchor">#</a> list 子命令</h4> <p>list 是一个辅助命令，作用是遍历输出所有要生成的文件列表。</p> <p>此处由于我们要生成的项目文件都封装在了 <code>acm-template</code> 目录下，所以直接用 Hutool 库提供的 <code>FileUtil.loopFiles(inputPath)</code> 方法来遍历该目录下的所有文件即可。</p> <p>完整代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Command</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;查看文件列表&quot;</span><span class="token punctuation">,</span> mixinStandardHelpOptions <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ListCommand</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> projectPath <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;user.dir&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 整个项目的根路径</span>
        <span class="token class-name">File</span> parentFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>projectPath<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParentFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 输入路径</span>
        <span class="token class-name">String</span> inputPath <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>parentFile<span class="token punctuation">,</span> <span class="token string">&quot;yuzi-generator-demo-projects/acm-template&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">File</span><span class="token punctuation">&gt;</span></span> files <span class="token operator">=</span> <span class="token class-name">FileUtil</span><span class="token punctuation">.</span><span class="token function">loopFiles</span><span class="token punctuation">(</span>inputPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">File</span> file <span class="token operator">:</span> files<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="config-子命令"><a href="#config-子命令" class="header-anchor">#</a> config 子命令</h4> <p>config 是一个辅助命令，作用是输出允许用户传入的动态参数的信息（也就是本项目 <code>MainTemplateConfig</code> 类的字段信息）。</p> <p>如何输出呢？</p> <p>最简单粗暴的方法是直接自己手写打印信息，比较灵活。但是如果配置类的属性字段发生修改，也要同步修改 config 命令的代码，不利于维护。</p> <p>更推荐的方式是通过 Java 的反射机制，在程序运行时动态打印出对象属性的信息。又有 2 种方法：</p> <p>1）JDK 原生反射语法</p> <p>示例代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> myClass <span class="token operator">=</span> <span class="token class-name">MainTemplateConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
<span class="token comment">// 获取类的所有字段</span>
<span class="token class-name">Field</span><span class="token punctuation">[</span><span class="token punctuation">]</span> fields <span class="token operator">=</span> myClass<span class="token punctuation">.</span><span class="token function">getDeclaredFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>2）Hutool 的反射工具类（只需一行代码，更推荐）</p> <p>示例代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Field</span><span class="token punctuation">[</span><span class="token punctuation">]</span> fields <span class="token operator">=</span> <span class="token class-name">ReflectUtil</span><span class="token punctuation">.</span><span class="token function">getFields</span><span class="token punctuation">(</span><span class="token class-name">MainTemplateConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>完整代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Command</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;config&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;查看参数信息&quot;</span><span class="token punctuation">,</span> mixinStandardHelpOptions <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigCommand</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 实现 config 命令的逻辑</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;查看参数信息&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//        // 获取要打印属性信息的类</span>
<span class="token comment">//        Class&lt;?&gt; myClass = MainTemplateConfig.class;</span>
<span class="token comment">//        // 获取类的所有字段</span>
<span class="token comment">//        Field[] fields = myClass.getDeclaredFields();</span>

        <span class="token class-name">Field</span><span class="token punctuation">[</span><span class="token punctuation">]</span> fields <span class="token operator">=</span> <span class="token class-name">ReflectUtil</span><span class="token punctuation">.</span><span class="token function">getFields</span><span class="token punctuation">(</span><span class="token class-name">MainTemplateConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 遍历并打印每个字段的信息</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Field</span> field <span class="token operator">:</span> fields<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;字段名称：&quot;</span> <span class="token operator">+</span> field<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;字段类型：&quot;</span> <span class="token operator">+</span> field<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//            System.out.println(&quot;Modifiers: &quot; + java.lang.reflect.Modifier.toString(field.getModifiers()));</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;---&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="_3、全局调用入口"><a href="#_3、全局调用入口" class="header-anchor">#</a> 3、全局调用入口</h3> <p>在项目的根包 <code>com.yupi</code> 下创建 Main 类，作为整个代码生成器项目的全局调用入口。作用是接受用户的参数、创建命令执行器并调用执行。</p> <p>代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CommandExecutor</span> commandExecutor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommandExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        commandExecutor<span class="token punctuation">.</span><span class="token function">doExecute</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>接下来我们需要对命令进行测试。建议直接在 main 方法中给 args 参数设置值来完成测试，比较灵活：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        args <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">&quot;generate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-l&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-o&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//        args = new String[]{&quot;config&quot;};</span>
<span class="token comment">//        args = new String[]{&quot;list&quot;};</span>
        <span class="token class-name">CommandExecutor</span> commandExecutor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommandExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        commandExecutor<span class="token punctuation">.</span><span class="token function">doExecute</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>1）测试 generate 命令，执行并得到输出结果：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181344589.png" loading="lazy" class="lazy"></p> <p>成功查看到生成的代码：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181344009.png" loading="lazy" class="lazy"></p> <p>2）测试 config 命令，输出结果如下图：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181344872.png" loading="lazy" class="lazy"></p> <p>3）测试 list 命令，输出结果如下图：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181344287.png" loading="lazy" class="lazy"></p> <h3 id="_4、jar-包构建"><a href="#_4、jar-包构建" class="header-anchor">#</a> 4、jar 包构建</h3> <p>虽然命令行程序已经开发完成，但是不能每次都让用户在 Main 方法里修改参数吧？</p> <p>我们可以将代码生成器打成 jar 包，支持用户执行并使用命令行工具动态输入参数。</p> <p>构建 jar 包的流程并不复杂：</p> <p>1）先修改 <code>Main.java</code> 主类，不再强制指定 args 参数，而是通过执行参数获取：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CommandExecutor</span> commandExecutor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommandExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        commandExecutor<span class="token punctuation">.</span><span class="token function">doExecute</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>2）使用 Maven 打包构建</p> <p>需要在 <code>pom.xml</code> 文件中引入 <code>maven-assembly-plugin</code> 插件，从而将依赖库一起打入 jar 包，并且指定 mainClass 路径为 <code>com.yupi.Main</code>。</p> <p>代码如下：</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>maven-assembly-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.3.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>descriptorRefs</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>descriptorRef</span><span class="token punctuation">&gt;</span></span>jar-with-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>descriptorRef</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>descriptorRefs</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>archive</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>manifest</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mainClass</span><span class="token punctuation">&gt;</span></span>com.hello.Main<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mainClass</span><span class="token punctuation">&gt;</span></span> 
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>manifest</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>archive</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executions</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>execution</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>phase</span><span class="token punctuation">&gt;</span></span>package<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>phase</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goals</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goal</span><span class="token punctuation">&gt;</span></span>single<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goal</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goals</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>execution</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executions</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>然后执行 <code>mvn package</code> 打包命令，即可构建 jar 包：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181344859.png" loading="lazy" class="lazy"></p> <p>可以在项目根目录下看到生成的 jar 包：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181344553.png" loading="lazy" class="lazy"></p> <h3 id="_5、测试使用"><a href="#_5、测试使用" class="header-anchor">#</a> 5、测试使用</h3> <p>得到 jar 包后，我们就可以通过 <code>java -jar</code> 命令运行 jar 包了。</p> <p>参考命令格式如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">java</span> <span class="token parameter variable">-jar</span> <span class="token operator">&lt;</span>jar 包名<span class="token operator">&gt;</span> generate <span class="token punctuation">[</span><span class="token punctuation">..</span>args<span class="token punctuation">]</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>1）让我们打开终端并进入到 target 目录中，输入下列命令交互式生成代码：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">java</span> <span class="token parameter variable">-jar</span> yuzi-generator-basic-1.0-SNAPSHOT-jar-with-dependencies.jar generate <span class="token parameter variable">-l</span> <span class="token parameter variable">-o</span> <span class="token parameter variable">-a</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>执行结果：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181344844.png" loading="lazy" class="lazy"></p> <p>2）或者直接在命令中指定部分参数，比如作者为 liyupi：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">java</span> <span class="token parameter variable">-jar</span> yuzi-generator-basic-1.0-SNAPSHOT-jar-with-dependencies.jar generate <span class="token parameter variable">-l</span> <span class="token parameter variable">-o</span> <span class="token parameter variable">-a</span> liyupi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>执行结果，不会再提示让我们输入作者（因为已经在命令中指定）：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181344413.png" loading="lazy" class="lazy"></p> <h3 id="_6、封装脚本"><a href="#_6、封装脚本" class="header-anchor">#</a> 6、封装脚本</h3> <p>虽然命令行工具已经可以成功使用，但是要输入的命令也太长、太复杂了！</p> <p>怎么简化调用呢？</p> <p>可以把命令的调用封装在一个 bash 脚本或者 windows 批处理文件，像封装一个函数一样，简化命令。</p> <h4 id="linux-bash-脚本"><a href="#linux-bash-脚本" class="header-anchor">#</a> Linux Bash 脚本</h4> <blockquote><p>适用于 Linux 和 Mac 系统</p></blockquote> <p>在项目 <code>yuzi-generator-basic</code> 的根目录下创建 <code>generator</code> 文件，输入脚本信息：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token function">java</span> <span class="token parameter variable">-jar</span> target/yuzi-generator-basic-1.0-SNAPSHOT-jar-with-dependencies.jar <span class="token string">&quot;<span class="token variable">$@</span>&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>然后输入命令 <code>chmod a+x generator</code> ，给该文件添加可执行权限。</p> <p>然后就可以简化使用了：</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181344420.png" loading="lazy" class="lazy"></p> <p>查看帮助提示，很方便！</p> <p><img alt="image.png" data-src="https://img.xiaoying.org.cn/img/202502181344498.png" loading="lazy" class="lazy"></p> <h4 id="windows-批处理文件"><a href="#windows-批处理文件" class="header-anchor">#</a> Windows 批处理文件</h4> <p>如果是 Windows 系统，在项目根目录下创建 <code>generator.bat</code> 文件，输入脚本信息：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>@echo off
<span class="token function">java</span> <span class="token parameter variable">-jar</span> target/yuzi-generator-basic-1.0-SNAPSHOT-jar-with-dependencies.jar %*
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>在上述批处理文件中：</p> <ul><li>@echo off 用于禁止在命令执行时显示命令本身。</li> <li>java -jar &lt;jar 包路径&gt; %* 执行 Java 命令，其中 %* 用于将批处理文件接收到的所有参数传递给 Java 应用程</li></ul> <p>然后就可以在终端中使用啦~</p> <h3 id="命令模式的巧妙运用"><a href="#命令模式的巧妙运用" class="header-anchor">#</a> 命令模式的巧妙运用</h3> <p>不知道大家有没有发现，其实在我们的代码中，已经浑然天成地运用了命令模式！</p> <p>命令模式的几个要素：</p> <ul><li>命令：<code>GenerateCommand</code> 等子命令中实现的 Runnable（或 Callable）接口</li> <li>具体命令：每个子命令类</li> <li>调用方：<code>CommandExecutor</code> 命令执行器类</li> <li>接受者：代码生成器 <code>MainGenerator</code> 类（实际执行功能的类）</li> <li>客户端：主程序 <code>Main</code></li></ul> <p>所以如果面试官问到：你的项目中哪里用到了设计模式？</p> <p>应该就能很好地回答啦~</p></div></div> <!----> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=%E6%98%9F%E7%90%83%E9%A1%B9%E7%9B%AE" title="标签">#星球项目</a><a href="/tags/?tag=%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E5%99%A8" title="标签">#代码生成器</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2025/02/18 14:25:08</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/7a1d12/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">开发本地代码生成器</div></a> <a href="/pages/617ec1/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">模板生成工具</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/7a1d12/" class="prev">开发本地代码生成器</a></span> <span class="next"><a href="/pages/617ec1/">模板生成工具</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/2e0a98/"><div>
            暂停windows更新
            <span class="title-tag">
              原创
            </span></div></a> <span class="date">07-30</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/eff348/"><div>
            关联到已存在的 GitHub 仓库
            <span class="title-tag">
              原创
            </span></div></a> <span class="date">07-28</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/f02c4b/"><div>
            numpy
            <span class="title-tag">
              原创
            </span></div></a> <span class="date">07-24</span></dt></dl><dl><dd>04</dd> <dt><a href="/pages/cf83bf/"><div>
            pandas 基础操作
            <span class="title-tag">
              原创
            </span></div></a> <span class="date">07-24</span></dt></dl><dl><dd>05</dd> <dt><a href="/pages/27beb1/"><div>
            node后端部署
            <span class="title-tag">
              原创
            </span></div></a> <span class="date">04-10</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="https://github.com/xugaoyi/vuepress-theme-vdoing" title="github" target="_blank" class="iconfont icon-github"></a><a href="https://mail.163.com/js6/main.jsp?sid=YAoleRcXgSntbqVGwDXXGltbASZPXVBD&amp;df=mail163_letter#module=compose.ComposeModule%7C%7B%22type%22%3A%22compose%22%2C%22fullScreen%22%3Atrue%2C%22cid%22%3A%22c%3A1702008591824%22%7D" title="邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://qm.qq.com/q/1qZrTBvhuU" title="QQ" target="_blank" class="iconfont icon-QQ"></a><a href=" https://b23.tv/XXqWiXR" title="哔哩哔哩" target="_blank" class="iconfont icon-bilibili"></a></div> 
    Copyright © 2023-2025
    <span><a target="_blank" href="https://github.com/liyao52033/vuepress-default">liyao52033</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div><div></div><div></div></div></div>
    <script src="/assets/js/app.0e4893f0.js" defer></script><script src="/assets/js/3.68e95ad6.js" defer></script><script src="/assets/js/2.56a7fb29.js" defer></script><script src="/assets/js/101.74a03766.js" defer></script><script src="/assets/js/25.571f3d43.js" defer></script><script src="/assets/js/45.ab1d84cf.js" defer></script><script src="/assets/js/44.6f56586a.js" defer></script>
  </body>
</html>
